<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>reveal.js â€“ The HTML Presentation Framework</title>
    <meta name="description" content="A framework for easily creating beautiful presentations using HTML">
    <meta name="author" content="Hakim El Hattab">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/white.css" id="theme">
    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css">
    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>
    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
  </head>
  <body>

    <div class="reveal">
      <div class="slides">
        <section>
          <h2>
            Conditional inference <br />  
            in differentiable  <br />
            generative models
          </h2>   
          <img src='images/mnist-generator-samples.svg' width='25%'
                style='background: none; border: none; box-shadow: none;' />
          <img src='images/pose-generator-samples.svg' width='25%'
            style='background: none; border: none; box-shadow: none;' />
          <img src='images/lotka-volterra-generator-samples.svg' width='25%'
            style='background: none; border: none; box-shadow: none;' />
          <p>
            Matt Graham
            <span style='color: #555; font-size: 70%;'>DTC Neuroinformatics / ANC</span>  
          </p>
          <p style='font-size: 80%;'>Joint work with Amos Storkey</p>
        </section>
        <section >
          <section data-markdown>
            <script type="text/template">
              ## Differentiable generator networks
              
              <img src='images/generator-example.svg' width='75%'
               style='background: none; border: none; box-shadow: none;' />
               
              e.g. Variational Autoencoder, Generative Adversial Network.
              
              Assume: $\frac{\partial\mathrm{\mathbf{g}}}{\partial \boldsymbol{u}}$ exists and 
              $M \geq N$.
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ## Example: MNIST images
              
              <img src='images/mnist-generator.svg' width='80%'
               style='background: none; border: none; box-shadow: none;' />
               
              Gaussian VAE trained on MNIST dataset
              
              $$
                  \boldsymbol{y} = 
                  \boldsymbol{\mu}(\boldsymbol{z}) + 
                  \boldsymbol{\sigma}(\boldsymbol{z}) \odot \boldsymbol{n}
                  \qquad
                  \boldsymbol{u} = \left[ \boldsymbol{z};\, \boldsymbol{n} \right]
              $$
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ## Example: Human poses
              
              <img src='images/pose-generator.svg' width='80%'
               style='background: none; border: none; box-shadow: none;' />
               
              $$\small
                  \overbrace{\boldsymbol{x}^{(i)}}^{\text{2D joint positions}} = 
                  \mathbf{C}(\overbrace{{\boldsymbol{\phi}}}^{\text{cam. params.}})
                  \mathbf{r}^{(i)}(\overbrace{\boldsymbol{\psi}}^{\text{joint angles}},\,
                  \overbrace{\boldsymbol{\ell}}^{\text{bone lengths}}) + 
                  \overbrace{\epsilon \boldsymbol{n}^{(i)}}^{\text{obs. noise}}
              $$
              
              $$\small
                 \boldsymbol{y} = \left[ \left\lbrace\boldsymbol{x}^{(i)}\right\rbrace;\,
                 \boldsymbol{\phi};\,\boldsymbol{\psi};\,\boldsymbol{\ell} \right]
                 \quad 
                 \left[\boldsymbol{\phi};\,\boldsymbol{\psi};\,\boldsymbol{\ell} \right]
                 = \mathbf{p}(\boldsymbol{z})
                 \quad
                 \boldsymbol{u} = \left[\boldsymbol{z};\,\left\lbrace\boldsymbol{n}^{(i)}\right\rbrace\right]
              $$
            </script>
          </section>
        </section>
        <section >
          <section data-markdown>
            <script type="text/template">
              ## Simulator models
              
              Many generative models involve simulation of
              stochastic dynamical systems e.g. 
              in systems biology
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ## Example: Lotka-Volterra model
              
              Model of prey ($x_1$) and predator ($x_2$) populations
              
              $$
                  \textrm{d} x_1 = (\theta_1 x_1 - \theta_2 x_1 x_2) \textrm{d} t + \textrm{d} n_1
              $$
              
              $$
                  \textrm{d} x_2 = (-\theta_3 x_2 + \theta_4 x_1 x_2) \textrm{d} t + \textrm{d} n_2
              $$
              
              where $n_1$ and $n_2$ are white noise processes.
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ## Example: Lotka-Volterra model
              
              Simulate at $T$ discrete time-steps
              
              $$
                  x_1^{(t+1)} = x_1^{(t)} + (\theta_1 x_1^{(t)} - \theta_2 x_1^{(t)} x_2^{(t)})\delta t + \sqrt{\delta t} n_1^{(t)}
              $$
              
              $$
                  x_2^{(t+1)} = x_2^{(t)} + (-\theta_3 x_2^{(t)} + \theta_4 x_1^{(t+1)} x_2^{(t)})\delta t + \sqrt{\delta t} n_2^{(t)}
              $$
              
              <br />
              
              $$
                  \boldsymbol{x} = 
                  \left[ 
                      x_1^{(1)},\, x_2^{(1)} \dots x_1^{(T)},\,x_2^{(T)}
                  \right]
                  \qquad
                  \boldsymbol{\theta} = \exp(\boldsymbol{z} - \boldsymbol{\mu})
              $$
              
              $$
                  \boldsymbol{u} = \left[ \boldsymbol{z};\,\boldsymbol{n} \right]
                  \qquad
                  \boldsymbol{y} = \left[ \boldsymbol{x};\,\boldsymbol{\theta} \right]
              $$
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ## Example: Lotka-Volterra model
              
              <img src='images/lotka-volterra-generator.svg' width='80%'
               style='background: none; border: none; box-shadow: none;' />
               
              Dynamics unstable for many parameter settings.
            </script>
          </section>
        </section>
        <section  data-markdown>
          <script type="text/template">
            ## Automatic differentiation
            
            <img src='https://upload.wikimedia.org/wikipedia/commons/a/a0/ReverseaccumulationAD.png'  
              width='80%' style='background: none; border: none; box-shadow: none;' />
            
            Image source: Wikipedia <!-- .element: style="font-size: 50%" -->
            
          </script>
        </section>
        <section  data-markdown>
          <script type="text/template">
            ## Conditional inference
            
            Make probabilistic inferences given observations
            
            $\boldsymbol{y}{\scriptstyle\textrm{obs}}$
            <img src='images/mnist-obs.png' width='10%' 
            style='vertical-align: middle; background: none; border: none; box-shadow: none;' /> 
            $\qquad \Rightarrow  \qquad  \boldsymbol{y}_{\textrm{rest}} = \textrm{?}$
            
            
            $\left\lbrace \boldsymbol{x}^{(i)} \right\rbrace =$
            <img src='images/pose-projection-obs.svg' width='10%' 
            style='vertical-align: middle; background: none; border: none; box-shadow: none;' /> 
            $\qquad \Rightarrow  \qquad \boldsymbol{\phi},\,\boldsymbol{\psi},\,\boldsymbol{\ell} = \textrm{?}$
            
            
            $\boldsymbol{x} =$ 
            <img src='images/lotka-volterra-obs.svg' width='10%' 
            style='vertical-align: middle; background: none; border: none; box-shadow: none;' /> 
            $\qquad \Rightarrow  \qquad \boldsymbol{\theta} = \textrm{?}$
            
          </script>
        </section>
        <section  data-markdown>
          <script type="text/template">
            ## Approximate Bayesian Computation (ABC)
            
            Inference when cannot evaluate $\mathbb{P}\left[\mathbf{X} = \boldsymbol{x} \,|\,\mathbf{\Theta} = \boldsymbol{\theta}\right]$?
            
            Approximate likelihood
            
            $$
                \mathbb{P}\left[
                    \tilde{\mathbf{X}} = \tilde{\boldsymbol{x}}
                    \,|\,
                    \mathbf{\Theta} = \boldsymbol{\theta}
                \right] =
                \int_{\mathcal{X}}
                  \mathbb{P}\left[
                      \tilde{\mathbf{X}} = \tilde{\boldsymbol{x}} \,|\, \mathbf{X} = \boldsymbol{x}
                  \right]
                  \mathbb{P}\left[
                      \mathbf{X} = \boldsymbol{x} \,|\, \mathbf{\Theta} = \boldsymbol{\theta}
                  \right]
                \, \mathrm{d}\boldsymbol{x}.
            $$
            
            Unbiased estimator
            
            $$
                \mathbb{P}\left[
                    \tilde{\mathbf{X}} = \tilde{\boldsymbol{x}}
                    \,|\,
                    \mathbf{\Theta} = \boldsymbol{\theta}
                \right]
                \approx
                \frac{1}{S} \sum_{s=1}^S \left\lbrace 
                    \mathbb{P}\left[
                        \tilde{\mathbf{X}} = \tilde{\boldsymbol{x}} \,|\, \mathbf{X} = \boldsymbol{x}^{(s)}
                    \right]
                \right\rbrace
            $$
            
            $$
                \boldsymbol{x}^{(s)} \sim 
                  \mathbb{P}\left[
                      \mathbf{X} = \boldsymbol{x}^{(s)} \,|\, \mathbf{\Theta} = \boldsymbol{\theta}
                  \right]
                ~~
                \forall s \in \left\lbrace1,\dots S\right\rbrace.
            $$
            
          </script>
        </section>
        <section >
          <section data-markdown>
            <script type="text/template">
              ## Experiments
              
                1. Parameter inference in Lotka-Volterra model
                2. Monocular pose and camera model inference
                3. Digit image in-painting with MNIST model
              
              <span style='vertical-align: middle;'>All generative models coded using </span>
              <img src='http://deeplearning.net/software/theano/_static/theano_logo_allblue.svg' width='15%'
               style='vertical-align: middle; background: none; border: none; box-shadow: none; margin: 10px;' />
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Lokta-Volterra parameter inference
              
              <img src='images/lotka-volterra-sims.svg' width='22%'
               style='background: none; border: none; box-shadow: none; margin: 10px;' />
              <img src='images/lotka-volterra-marginals.svg' width='35%'
               style='background: none; border: none; box-shadow: none; margin: 10px;' />
              <img src='images/lotka-volterra-ess.svg' width='33%'
               style='background: none; border: none; box-shadow: none; margin: 10px;' />
              
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Monocular pose estimation
              
              <img src='images/pose-projection-obs.svg' width='22.7%'
               style='background: none; border: none; box-shadow: none;' />
              <img src='images/pose-projection-samples.svg' width='50%'
               style='background: none; border: none; box-shadow: none;' />
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### MNIST in-painting
              
              <img src='images/mnist-chmc-samples.png' width='80%'
               style='background: none; border: none; box-shadow: none;' />
              
              <aside class="notes" data-markdown>Find in-paintings for bottom of digit image given observation of
              top pixels.
              
              Dynamic able to move between range of plausible in-filling consistent with
              observations.</aside>
            </script>
          </section>
        </section>
        <section  data-markdown>
          <script type="text/template">
            <h2 style='font-size: 250%;'>References</h2>
            
            <!-- .slide: style="font-size: 50%" -->
            
            > M. A. Brubaker, M. Saelzmann, and R. Urtasun.
            > A family of MCMC methods on implicitly defined manifolds. 
            > *AISTATS*, 2012.
            
            > D. P. Kingma and M. Welling. 
            > Auto-encoding variational Bayes. 
            > *ICLR*, 2014.
            
            > I. Goodfellow, Y. Bengio, and A. Courville. 
            > Deep learning. 
            > *Book in preparation for MIT Press*, 2016.
            
            > I. G.oodfellow, J. Pouget-Abadie, M. Mirza, B. Xu, D. Warde-Farley, S. Ozair, 
            > A. Courville, and Y. Bengio.
            > Generative adversarial nets. 
            > *NIPS*, 2014.
            
            > I. Akhter and M. J. Black. 
            > Pose-conditioned joint angle limits for 3D human pose reconstruction. 
            > *IEEE CVPR*, 2015.
            
            > J.-M. Marin, P. Pudlo, C. P. Robert, and R. J. Ryder. 
            > Approximate Bayesian computational methods. 
            > *Statistics and Computing*, 2012.
          </script>
        </section>
        <section  data-markdown>
          <script type="text/template">
            ## Acknowledgements
            
            <img src='images/informatics-logo.svg' width='35%'
             style='background: none; border: none; box-shadow: none;' />
            
            <div style='display: inline-block;'>
               <img src='images/dtc-logo.svg' height='80px'
                 style='vertical-align: middle; display: inline-block; background: none; border: none; box-shadow: none; margin: 10px;' />
               <div style='display: inline-block; width: 200px; vertical-align: middle; font-variant: small-caps; font-size: 45%;'>
                   Doctoral Training Centre in Neuroinformatics and Computational Neuroscience
               </div> 
            </div>
            
            
            Many thanks to the DTC funders
            
            <div>
               <img src='images/epsrc-logo.svg' height='60px'
                 style='background: none; border: none; box-shadow: none; margin: 10px;' />
               <img src='images/bbsrc-logo.svg' height='40px'
                 style='background: none; border: none; box-shadow: none; margin: 10px;' />
               <img src='images/mrc-logo.svg' height='60px'
                 style='background: none; border: none; box-shadow: none; margin: 10px;' /> 
            </div>
          </script>
        </section>
        <section  data-markdown>
          <script type="text/template">
            ## Thanks for listening. 
            ## Any questions?
            
            <br />
            
            `python` constrained HMC code
            
            http://github.com/matt-graham/hmc.git
            
            
          </script>
        </section>
      </div>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>
    <script>
      function extend() {
        var target = {};
        for (var i = 0; i < arguments.length; i++) {
          var source = arguments[i];
          for (var key in source) {
            if (source.hasOwnProperty(key)) {
              target[key] = source[key];
            }
          }
        }
        return target;
      }
      
      // Optional libraries used to extend on reveal.js
      var deps = [
        { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
        { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector('[data-markdown]'); } },
        { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector('[data-markdown]'); } },
        { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
        { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
        { src: 'plugin/math/math.js', async: true }
      ];
      
      // default options to init reveal.js
      var defaultOptions = {
        controls: true,
        progress: true,
        history: true,
        center: true,
        transition: 'default',
        dependencies: deps
      };
      
      // options from URL query string
      var queryOptions = Reveal.getQueryHash() || {};
      
      var options = {
      "transition": "fade"
      };
      options = extend(defaultOptions, options, queryOptions);
      Reveal.initialize(options);
    </script>
  </body>
</html>
